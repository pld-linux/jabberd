--- jabberd-2.0b1.orig/scod/mech_digest_md5.c	Fri Aug 29 13:05:01 2003
+++ jabberd-2.0b1/scod/mech_digest_md5.c	Thu Sep 18 12:47:34 2003
@@ -631,9 +631,9 @@
 
     *chal = (char *) malloc(sizeof(char) * 41);
     snprintf(*chal, 41, "rspauth=%s", hrsp);
-    *challen = 41;
+    *challen = 40;
 
-    log_debug(ZONE, "generated final challenge: %.*s", 41, *chal);
+    log_debug(ZONE, "generated final challenge: %.*s", 40, *chal);
 
     md->step = 1;
     
